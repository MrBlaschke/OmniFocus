use AppleScript version "2.4"use scripting additionsuse O : script "omnifocus"use OmniFocus : application "OmniFocus"use framework "Foundation"-- classes, constants, and enums usedproperty NSCharacterSet : a reference to current application's NSCharacterSetproperty NSString : a reference to current application's NSStringtell application "OmniFocus"	set sel to selectedItems() of O	repeat with _sel in sel		local _paragraph		repeat with _paragraph in (get paragraphs of note of _sel)			if _paragraph starts with "sh" then				do shell script text 4 thru -1 of _paragraph			else if _paragraph contains "://" then				set target to ((NSString's stringWithString:_paragraph)'s stringByTrimmingCharactersInSet:(NSCharacterSet's whitespaceAndNewlineCharacterSet())) as text				--					set target to text of _paragraph				do shell script "open " & quoted form of target			else if _paragraph starts with "App:" then				set strippedParagraph to ((NSString's stringWithString:_paragraph)'s stringByTrimmingCharactersInSet:(NSCharacterSet's whitespaceAndNewlineCharacterSet())) as text				set target to "-a " & quoted form of (text 6 thru -1 of strippedParagraph)				do shell script "open " & target			else if _paragraph starts with "Notify:" then				set strippedParagraph to ((NSString's stringWithString:_paragraph)'s stringByTrimmingCharactersInSet:(NSCharacterSet's whitespaceAndNewlineCharacterSet())) as text				set target to (get text 8 through -1 of strippedParagraph)				display notification target			else if _paragraph starts with "Alert:" then				set strippedParagraph to ((NSString's stringWithString:_paragraph)'s stringByTrimmingCharactersInSet:(NSCharacterSet's whitespaceAndNewlineCharacterSet())) as text				set target to (get text 7 through -1 of strippedParagraph)				display alert target			else if length of (get file name of first file attachment of file attachments of note of first item of _sel) is not 0 then				repeat with _attachment in file attachments of note of _sel					set target to POSIX path of (get file name of _attachment)					do shell script "open " & quoted form of target				end repeat			else if value of attribute named "link" of style of _paragraph is not "" then				set target to ((NSString's stringWithString:(value of attribute named "link" of style of _paragraph))'s stringByTrimmingCharactersInSet:(NSCharacterSet's whitespaceAndNewlineCharacterSet())) as text				set target to value of attribute named "link" of style of _paragraph				do shell script "open " & quoted form of target			else				display notification "Nothing to open."			end if		end repeat		set completed of _sel to true	end repeatend tell